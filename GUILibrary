local GUI = {}

if game.CoreGui:FindFirstChild("ScriptGui") then
    game.CoreGui:FindFirstChild("ScriptGui"):Destroy()
end

if _G.HideKeybind == nil then _G.HideKeybind = Enum.KeyCode.P end

local ScriptGui = Instance.new("ScreenGui")
ScriptGui.Name = "ScriptGui"
ScriptGui.Parent = game.CoreGui

local UIS = game:GetService("UserInputService")
local TS = game:GetService("TweenService")
local locPlayer = game.Players.LocalPlayer
local visible, Usable = true, true

UIS.InputBegan:Connect(function(input, gameProcesses)
    if gameProcesses or input.KeyCode ~= _G.HideKeybind or not Usable then return end
    Usable = false
    visible = not visible
    for _, v in pairs(ScriptGui:GetDescendants()) do
        if v:IsA("GuiObject") then
            v.Visible = visible
        end
    end
    Usable = true
end)

function GUI:Window()
    local Window = {}

    local Main = Instance.new("Frame", ScriptGui)
    local UICMain = Instance.new("UICorner", Main)
    local Line = Instance.new("Frame", Main)
    local UIGLine = Instance.new("UIGradient", Line)
    local Title = Instance.new("Frame", Main)
    local TabHolder = Instance.new("ScrollingFrame", Main)
    local UIGLTabHolder = Instance.new("UIGridLayout", TabHolder)

    Main.Name = "Main"
    Main.Size = UDim2.new(0,650,0,450)
    Main.Position = UDim2.new(0.5,-325,0.5,-225)
    Main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    UICMain.CornerRadius = UDim.new(0, 8)

    Line.Name = "Line"
    Line.Position = UDim2.new(0.025,0,0.10,0)
    Line.Size = UDim2.new(0.95,0,0,3)
    Line.BorderSizePixel = 0
    Line.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    UIGLine.Transparency = NumberSequence.new{
        NumberSequenceKeypoint.new(0,0.98),
        NumberSequenceKeypoint.new(0.25,0),
        NumberSequenceKeypoint.new(0.5,0),
        NumberSequenceKeypoint.new(0.75,0),
        NumberSequenceKeypoint.new(1,0.98)
    }

    Title.Name = "Title"
    Title.Position = UDim2.new(0,0,0,0)
    Title.Size = UDim2.new(1,0,0.15,0)
    Title.BackgroundTransparency = 1
    Title.BorderSizePixel = 0

    TabHolder.Name = "TabsHolder"
    TabHolder.Position = UDim2.new(0.025,0,0.175,0)
    TabHolder.Size = UDim2.new(0.15,0,0.8,0)
    TabHolder.BackgroundTransparency = 1
    TabHolder.BorderSizePixel = 0
    TabHolder.ScrollBarThickness = 0

    UIGLTabHolder.CellPadding = UDim2.new(0,1,0,10)
    UIGLTabHolder.FillDirection = Enum.FillDirection.Vertical
    UIGLTabHolder.VerticalAlignment = Enum.VerticalAlignment.Top
    UIGLTabHolder.CellSize = UDim2.new(1,0,0,90)
    

    local function UIGL(scrollFrame)
        local grid = scrollFrame:FindFirstChildOfClass("UIGridLayout")
        grid:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            scrollFrame.CanvasSize = UDim2.new(0, 0, 0, grid.AbsoluteContentSize.Y + 10)
            scrollFrame.ScrollingEnabled = grid.AbsoluteContentSize.Y > scrollFrame.AbsoluteSize.Y
        end)
    end
    UIGL(UIGLTabHolder)

    local function MakeDrag(frame, handle)
        local dragging = false
        local dragStart, startPos

        handle.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = frame.Position
            end
        end)

        handle.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)

        UIS.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local delta = input.Position - dragStart
                frame.Position = startPos + UDim2.fromOffset(delta.X, delta.Y)
            end
        end)
    end
    MakeDrag(Main, Title)


    return Window 
end

return GUI
